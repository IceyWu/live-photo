<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Vue 3 LivePhoto Viewer Demo</title>
    <script src="https://fastly.jsdelivr.net/npm/live-photo@latest"></script>
    <!-- <script src="../dist/LivePhotoViewer.js"></script> -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
  </head>
  <body>
    <div id="vue3-demo"></div>
    <script>
      const { createApp, ref, onMounted } = Vue;

      const App = {
        setup() {
          const demoSource = {
            photoSrc:
              "https://nest-js.oss-accelerate.aliyuncs.com/nestTest/1/1733058160256.JPEG",
            videoSrc:
              "https://nest-js.oss-accelerate.aliyuncs.com/nestTest/1/1733058160657.MOV",
          };
          const containerRef = ref(null);
          const viewerInstance = ref(null);

          onMounted(() => {
            if (containerRef.value) {
              viewerInstance.value = new LivePhotoViewer({
                photoSrc: demoSource.photoSrc,
                videoSrc: demoSource.videoSrc,
                container: containerRef.value,
                height: "100%",
                borderRadius: "8px",
                autoplay: true,
                lazyLoadVideo: false,
                longPressDelay: 300,
                enableVibration: true,
                imageCustomization: {
                  styles: {
                    objectFit: "cover",
                  },
                  attributes: {
                    alt: "Live Photo Demo",
                    loading: "lazy",
                  },
                },
                videoCustomization: {
                  styles: {
                    objectFit: "cover",
                  },
                },
                onPhotoLoad: () => {
                  console.log("Photo loaded");
                },
                onVideoLoad: () => {
                  console.log("Video loaded");
                },
                onCanPlay: () => {
                  console.log("Video can play");
                },
                onEnded: () => {
                  console.log("Video ended");
                },
                onError: (error) => {
                  console.error("Error:", error);
                },
                onProgress: (progress) => {
                  console.log("Loading progress:", progress + "%");
                },
                onClick: () => {
                  console.log("Clicked!");
                },
              });

              // Example: Using public API methods
              // viewerInstance.value.play();
              // viewerInstance.value.pause();
              // viewerInstance.value.stop();
              // viewerInstance.value.toggle();
              // console.log(viewerInstance.value.getState());
            }
          });

          return { containerRef };
        },
        template: '<div style="height: 40vh;" ref="containerRef"></div>',
      };

      createApp(App).mount("#vue3-demo");
    </script>
  </body>
</html>
